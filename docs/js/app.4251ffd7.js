(function(e){function t(t){for(var a,r,s=t[0],o=t[1],l=t[2],d=0,b=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&b.push(i[r][0]),i[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);u&&u(t);while(b.length)b.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,s=1;s<n.length;s++){var o=n[s];0!==i[o]&&(a=!1)}a&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},c=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/textwg/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=o;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"018e":function(e,t,n){},1:function(e,t){},2:function(e,t){},"297a":function(e,t,n){"use strict";n("9f47")},"32f9":function(e,t,n){},"377c":function(e,t,n){"use strict";n("3d27")},"3d27":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),i={id:"app"};function c(e,t){var n=Object(a["E"])("router-view");return Object(a["w"])(),Object(a["h"])("div",i,[Object(a["l"])(n)])}n("377c");var r=n("6b0d"),s=n.n(r);const o={},l=s()(o,[["render",c]]);var u=l,d=n("5502"),b=Object(d["a"])({state:{m3:null,bid:null,selectedText:{},param:{},texts:[{provider:"NIJL",items:[{title:"十六夜日記",manifestURI:"https://kotenseki.nijl.ac.jp/biblio/200003074/manifest",xmls:[{label:"上",uri:"https://raw.githubusercontent.com/TEI-EAJ/jpn_classical/master/%E2%91%A1%E6%A0%A1%E8%A8%82%E6%9C%AC%E6%96%87%E3%83%87%E3%83%BC%E3%82%BF%E5%9B%BD%E6%96%87%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B3%87%E6%96%99%E9%A4%A8%E6%89%80%E8%94%B5%E3%80%8E%E5%8D%81%E5%85%AD%E5%A4%9C%E7%89%A9%E8%AA%9E%E3%80%8F%E4%B8%8A%E5%B7%BB.xml"},{label:"下",uri:"https://raw.githubusercontent.com/TEI-EAJ/jpn_classical/master/%E2%91%A1%E6%A0%A1%E8%A8%82%E6%9C%AC%E6%96%87%E3%83%87%E3%83%BC%E3%82%BF%E5%9B%BD%E6%96%87%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B3%87%E6%96%99%E9%A4%A8%E6%89%80%E8%94%B5%E3%80%8E%E5%8D%81%E5%85%AD%E5%A4%9C%E7%89%A9%E8%AA%9E%E3%80%8F%E4%B8%8B%E5%B7%BB.xml"}]},{title:"源氏物語",manifestURI:"https://nakamura196.github.io/jpsearch/data/genji/manifest/01.json",xmls:[{label:"第1冊",uri:"https://tei-eaj.github.io/parallel_text_viewer/data/pt/01.xml"}]}]},{provider:"KU-ORCAS",items:[{title:"廣瀬本万葉集",manifestURI:"https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/210464810/manifest.json",xmls:[{label:"210464810",uri:"https://raw.githubusercontent.com/KU-ORCAS/manyoshuTEI/main/manyo_hirose_v02_85_140a.xml"}]}]}]},getters:{},mutations:{setM3:function(e,t){e.m3=t,console.info("store: setM3:",t)},setSelectedText:function(e,t){e.selectedText=t,console.info("store: setSelectedText:",e.selectedText)},setParam:function(e,t){e.param=t,console.info("store: setParam:",t)}},actions:{setParam:function(e,t){var n=e.commit;n("setParam",t)}}}),m=n("6c02"),f=Object(a["i"])("p",{class:"fixed top-0 right-0"},"v20220208001",-1);function h(e,t,n,i,c,r){var s=Object(a["E"])("ImageViewer");return Object(a["w"])(),Object(a["h"])(a["a"],null,[f,Object(a["l"])(s)],64)}var p={class:"miradorviewer"},j={class:"textviewer"};function O(e,t,n,i,c,r){var s=Object(a["E"])("DropDown"),o=Object(a["E"])("mdicon"),l=Object(a["E"])("SelectButton"),u=Object(a["E"])("Mirador3"),d=Object(a["E"])("SplitterPanel"),b=Object(a["E"])("TextViewer"),m=Object(a["E"])("Splitter");return Object(a["w"])(),Object(a["h"])(a["a"],null,[Object(a["l"])(s,{modelValue:r.selectedText,"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.selectedText=e}),options:r.texts,optionLabel:"title",optionGroupChildren:"items",optionGroupLabel:"provider"},null,8,["modelValue","options"]),Object(a["l"])(l,{modelValue:c.layout,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.layout=e}),options:c.layoutOptions,optionValue:"value"},{option:Object(a["N"])((function(e){return[Object(a["l"])(o,{name:e.option.icon},null,8,["name"])]})),_:1},8,["modelValue","options"]),Object(a["l"])(m,{layout:c.layout},{default:Object(a["N"])((function(){return[Object(a["l"])(d,null,{default:Object(a["N"])((function(){return[Object(a["i"])("div",p,[Object(a["l"])(u,{"mirador-id":"mirador"})])]})),_:1}),Object(a["l"])(d,null,{default:Object(a["N"])((function(){return[Object(a["i"])("div",j,[Object(a["l"])(b)])]})),_:1})]})),_:1},8,["layout"])],64)}var v=n("3835"),x=n("0100"),w=n("237b"),E=n("1e02"),g=["id"];function y(e,t,n,i,c,r){return Object(a["w"])(),Object(a["h"])("div",{id:this.miradorId,class:"mirador"},null,8,g)}var T={name:"Mirador3",props:["miradorId"],data:function(){return{}},computed:{m3:function(){return this.$store.state.m3},selectedText:function(){return this.$store.state.selectedText},texts:function(){return this.$store.state.texts},param:function(){return this.$store.state.param}},methods:{getM3Window:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"windowDefault";return this.m3.store.getState().windows[e]},getM3ManifestJSON:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"windowDefault",t=this.m3.store.getState();return t.manifests[t.windows[e].manifestId].json},initM3:function(){var e=window.Mirador.viewer({language:"ja",id:this.miradorId,window:{sideBarOpenByDefault:!1}});this.$store.commit("setM3",e),window.m3=e},setM3Text:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"windowDefault";null!==this.getM3Window(t)?this.m3.store.dispatch(window.Mirador.actions.addWindow({id:t,manifestId:e.manifestURI})):(console.info("m3 update"),this.m3.store.dispatch(window.Mirador.actions.updateWindow(t,{manifestId:e.manifestURI})))},setM3CanvasById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"windowDefault";this.m3.store.dispatch(window.Mirador.actions.setCanvas(t,e))},setM3CanvasByFrame:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"windowDefault";this.setM3CanvasById(this.getM3ManifestJSON(t).sequences[0].canvases[e]["@id"])}},mounted:function(){this.initM3()},watch:{selectedText:{handler:function(e){this.setM3Text(e)},deep:!0},param:{handler:function(e){switch(e.key){case"frame":this.setM3CanvasByFrame(e.value);break;case"canvasId":this.setM3CanvasById(e.value);break;default:console.error("unexpected setParam key")}},deep:!0}}};n("297a");const I=s()(T,[["render",y],["__scopeId","data-v-25af5c44"]]);var B=I,M=function(e){return Object(a["z"])("data-v-032c552e"),e=e(),Object(a["x"])(),e},k=M((function(){return Object(a["i"])("span",{class:"text-sm"},"Label",-1)})),A={class:"text-sm"},D=M((function(){return Object(a["i"])("span",{class:"text-sm"},"XML URI",-1)})),_={class:"text-sm"},C=["href"];function L(e,t,n,i,c,r){var s=this,o=Object(a["E"])("Card"),l=Object(a["E"])("AccordionTab"),u=Object(a["E"])("Accordion"),d=Object(a["E"])("SideBar"),b=Object(a["E"])("mdicon"),m=Object(a["E"])("Tei"),f=Object(a["E"])("ScrollPanel"),h=Object(a["E"])("TabPanel"),p=Object(a["E"])("TabView");return Object(a["w"])(),Object(a["h"])(a["a"],null,[Object(a["l"])(d,{visible:c.visibleRight,"onUpdate:visible":t[0]||(t[0]=function(e){return c.visibleRight=e}),position:"right",closeButton:"ture"},{default:Object(a["N"])((function(){return[Object(a["l"])(u,{multiple:"",activeIndex:[0,1],lazy:""},{default:Object(a["N"])((function(){return[Object(a["l"])(l,{header:"XML Metadata"},{default:Object(a["N"])((function(){return[Object(a["l"])(o,null,{title:Object(a["N"])((function(){return[k]})),content:Object(a["N"])((function(){return[Object(a["i"])("span",A,Object(a["I"])(s.selectedXML.label),1)]})),_:1}),Object(a["l"])(o,null,{title:Object(a["N"])((function(){return[D]})),content:Object(a["N"])((function(){return[Object(a["i"])("span",_,[Object(a["i"])("a",{target:"_blank",href:s.selectedXML.uri},Object(a["I"])(decodeURIComponent(s.selectedXML.uri)),9,C)])]})),_:1})]})),_:1}),Object(a["l"])(l,{header:"TEI Header"},{default:Object(a["N"])((function(){return[Object(a["l"])(o,null,{content:Object(a["N"])((function(){return[Object(a["i"])("pre",null,Object(a["I"])(s.jsonPrettify(s.xmlJsGetObjectByTagname("teiHeader"))),1)]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["visible"]),Object(a["i"])("div",null,[Object(a["i"])("span",null,Object(a["I"])(this.selectedText.title),1),Object(a["l"])(b,{name:"menu",class:"absolute right-0",onClick:t[1]||(t[1]=function(e){return s.visibleRight=!s.visibleRight})})]),Object(a["l"])(p,{ref:"tv",activeIndex:c.tabActiveIndex,"onUpdate:activeIndex":t[2]||(t[2]=function(e){return c.tabActiveIndex=e}),onTabChange:r.onTabChanged},{default:Object(a["N"])((function(){return[(Object(a["w"])(!0),Object(a["h"])(a["a"],null,Object(a["C"])(r.selectedText.xmls,(function(e){return Object(a["w"])(),Object(a["f"])(h,{key:e.label,header:e.label},{default:Object(a["N"])((function(){return[Object(a["l"])(f,{ref:"sp"+e.label,style:{width:"100%",height:"100%"}},{default:Object(a["N"])((function(){return[s.selectedXMLData.elements?(Object(a["w"])(),Object(a["h"])("div",{key:0,ref:"viewer".concat(e.label),class:"tategaki"},[Object(a["l"])(m,{el:s.selectedXMLData.elements[0].elements[1]},null,8,["el"])],512)):Object(a["g"])("",!0)]})),_:2},1536)]})),_:2},1032,["header"])})),128))]})),_:1},8,["activeIndex","onTabChange"])],64)}var N=n("1da1"),S=(n("d3b7"),n("99af"),n("159b"),n("b0c0"),n("96cf"),n("bc3a")),J=n.n(S),P=n("c51a"),X=n.n(P),R=n("de53"),$=n("c8c8"),V=n("9899"),U=n("ae1f"),W=n("427b"),G=n("c982"),F=n("eeae"),z={key:0},H={key:2,class:"tei-lb"},q={class:"tei-pb"},K=["href"];function Q(e,t,n,i,c,r){var s=this,o=Object(a["E"])("mdicon"),l=Object(a["E"])("Tei",!0);return null!==this.el?(Object(a["w"])(),Object(a["h"])(a["a"],{key:0},[Object(a["i"])("span",{class:Object(a["s"])("".concat(this.el.type," ").concat(this.el.name))},null,2),"text"===this.el.type?(Object(a["w"])(),Object(a["h"])(a["a"],{key:0},[""!==this.el.text?(Object(a["w"])(),Object(a["h"])("span",z,Object(a["I"])(this.el.text),1)):Object(a["g"])("",!0)],64)):"graphic"===this.el.name?(Object(a["w"])(),Object(a["h"])(a["a"],{key:1},[this.el.attributes.n?(Object(a["w"])(),Object(a["f"])(o,{key:0,name:"book-open-page-variant-outline",title:"ビューワで開く",onClick:t[0]||(t[0]=Object(a["Q"])((function(e){return r.jumpToByCanvasId(s.el.attributes.n)}),["prevent"]))})):Object(a["g"])("",!0)],64)):"lb"===this.el.name?(Object(a["w"])(),Object(a["h"])("br",H)):"pb"===this.el.name?(Object(a["w"])(),Object(a["h"])(a["a"],{key:3},[Object(a["i"])("span",q,"【"+Object(a["I"])(this.esc(this.el.attributes.n))+"】",1),this.el.attributes.facs?(Object(a["w"])(),Object(a["h"])(a["a"],{key:0},[Object(a["i"])("a",{target:"_blank",href:this.el.attributes.facs},[Object(a["l"])(o,{name:"open-in-new",title:"外部DBで開く"})],8,K),Object(a["l"])(o,{name:"book-open-page-variant-outline",title:"ビューワで開く",onClick:t[1]||(t[1]=Object(a["Q"])((function(e){return r.jumpToByURI(s.el.attributes.facs)}),["prevent"]))})],64)):Object(a["g"])("",!0)],64)):(Object(a["w"])(!0),Object(a["h"])(a["a"],{key:4},Object(a["C"])(this.el.elements,(function(e,t){return Object(a["w"])(),Object(a["h"])("span",{key:t,class:Object(a["s"])("tei-".concat(e.name))},[Object(a["l"])(l,{el:e,parents:s.parents.concat(s.el.name)},null,8,["el","parents"])],2)})),128))],64)):Object(a["g"])("",!0)}n("ac1f"),n("5319");var Y={props:{el:{type:Object,default:null,required:!0},parents:{type:Array,default:function(){return[]},required:!1}},watch:{el:function(){console.debug(111,this.el)}},methods:{esc:function(e){return e||""},jumpToByCanvasId:function(e){this.$store.dispatch("setParam",{key:"canvasId",value:e})},jumpToByURI:function(e){if(0!==e.indexOf("//kotenseki.nijl.ac.jp/")){var t=e.replace(/^.*\/(\d+)/,"$1")-1;this.$store.dispatch("setParam",{key:"frame",value:t})}}},mounted:function(){if(null!==this.$el&&0===this.parents.length){var e=this.$el.parentNode.parentNode;0!==e.scrollWidth&&(e.scrollLeft=e.scrollWidth)}}};const Z=s()(Y,[["render",Q]]);var ee=Z,te={name:"TextViewer",components:{Accordion:R["a"],AccordionTab:$["a"],Card:V["a"],SideBar:W["a"],ScrollPanel:U["a"],TabPanel:G["a"],TabView:F["a"],Tei:ee},data:function(){return{visibleRight:!1,tabActiveIndex:0,xmlData:{},selectedXMLIndex:null,teiData:{els:{},maps:{}}}},computed:{m3:function(){return this.$store.state.m3},selectedText:function(){return this.$store.state.selectedText},selectedXML:function(){return null===this.selectedXMLIndex?null:this.selectedText.xmls[this.selectedXMLIndex]},selectedXMLData:function(){return null===this.selectedXML||void 0===this.xmlData[this.selectedXML.uri]?{}:this.xmlData[this.selectedXML.uri]}},methods:{getCanvasById:function(e){return this.$store.getters.getCanvasById(e)},resetText:function(){var e=this;this.xmlLoaded=[],this.selectedXMLIndex=null,this.tabActiveIndex=0,this.teiData={els:{},maps:{}},this.$nextTick((function(){e.selectedXMLIndex=0}))},loadXML:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.selectedText.xmls[e],void 0!==t.xmlData[a.uri]){n.next=13;break}return n.prev=2,n.next=5,J.a.get(a.uri);case 5:i=n.sent,t.xmlData[a.uri]=X.a.xml2js(i.data,{ignoreDeclaration:!0,ignoreInstruction:!0,ignoreComment:!0}),t.xmlData.curr=t.xmlData[a.uri],n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](2),console.error("TextViewer: loadXML:",n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,10]])})))()},onTabChanged:function(e){this.selectedXMLIndex=e.index},xmlJsToText:function(e){return e.elements.reduce(this.xmlJsToTextWalk,"")},xmlJsToTextWalk:function(e,t){return"text"===t.type?"".concat(e).concat(t.text):t.elements.reduce(this.xmlJsToTextWalk,e)},xmlJsGetObjectByTagname:function(e){return void 0===this.teiData.els[e]&&this.xmlJsGetObjectsByTagnameInit(e),this.teiData.els[e].length>0?this.teiData.els[e][0]:null},xmlJsGetObjectsByTagname:function(e){return void 0===this.teiData.els[e]&&this.xmlJsGetObjectsByTagnameInit(e),this.teiData.els[e]},xmlJsGetObjectsByTagnameInit:function(e){this.teiData.els[e]=[],this.xmlJsGetObjectsByTagnameInitWalk(this.xmlData.curr,e)},xmlJsGetObjectsByTagnameInitWalk:function(e,t){var n=this;e.elements&&e.elements.forEach((function(e){e.name===t?n.teiData.els[t].push(e):n.xmlJsGetObjectsByTagnameInitWalk(e,t)}))},xmlJsToMapByTagname:function(e){var t=this;this.teiData.maps[e]={},this.xmlJsGetObjectsByTagname(e).forEach((function(n){t.teiData.maps[e][n.attributes["xml:id"]]=t.xmlJsToText(n)}))},jsonPrettify:function(e){return e?X.a.json2xml(e,{spaces:2,fullTagEmptyElement:!0,indentCdata:!0,indentAttributes:!0}):""}},mounted:function(){},watch:{selectedText:{handler:function(){this.resetText()},deep:!0},selectedXMLIndex:{handler:function(e){null!==e&&this.loadXML(e)},deep:!0}}};n("a606");const ne=s()(te,[["render",L],["__scopeId","data-v-032c552e"]]);var ae=ne,ie={name:"ImageViewer",components:{DropDown:x["a"],Splitter:w["a"],SplitterPanel:E["a"],Mirador3:B,TextViewer:ae},data:function(){return{layout:"horizontal",layoutOptions:[{icon:"view-split-vertical",value:"horizontal"},{icon:"view-split-horizontal",value:"vertical"}]}},computed:{selectedText:{get:function(){return this.$store.state.selectedText},set:function(e){this.$store.commit("setSelectedText",e)}},texts:function(){return this.$store.state.texts}},mounted:function(){var e=this;this.$nextTick((function(){var t=Object(v["a"])(e.texts[0].items,1);e.selectedText=t[0]}))}};n("bb26");const ce=s()(ie,[["render",O],["__scopeId","data-v-83f8733e"]]);var re=ce,se={name:"Home",components:{ImageViewer:re}};const oe=s()(se,[["render",h]]);var le=oe,ue=[{path:"/",name:"Home",component:le}],de=Object(m["a"])({history:Object(m["b"])("/textwg/"),routes:ue}),be=de,me=n("4b99"),fe=n("94ed"),he=n("9319"),pe=n("bb57"),je=n("8398"),Oe=n("a5af"),ve=(n("c461"),n("e1ae"),n("4121"),n("22a3"),{accept:"はい",reject:"いいえ",choose:"選択",upload:"アップロード",cancel:"キャンセル",dayNames:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],dayNamesShort:["日","月","火","水","木","金","土"],dayNamesMin:["日","月","火","水","木","金","土"],monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今日",clear:"クリア",weekHeader:"週",firstDayOfWeek:0,dateFormat:"yy/mm/dd",weak:"弱い",medium:"普通",strong:"強い",passwordPrompt:"パスワードを入力"});Object(a["e"])(u).use(b).use(be).use(me["a"],{icons:fe}).use(he["a"],{locale:ve}).component("Button",pe["a"]).component("InputText",je["a"]).component("SelectButton",Oe["a"]).mount("#app")},"9f47":function(e,t,n){},a606:function(e,t,n){"use strict";n("32f9")},bb26:function(e,t,n){"use strict";n("018e")}});
//# sourceMappingURL=app.4251ffd7.js.map